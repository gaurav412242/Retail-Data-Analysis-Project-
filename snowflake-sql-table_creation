CREATE DATABASE RETAIL ;
USE RETAIL ;

CREATE OR REPLACE TABLE DEMOGRAPHIC (
AGE_DESC CHAR(20),
MARITAL_STATUS_CODE CHAR(10),
INCOME_DESC VARCHAR(50),
HOMEOWNER_DESC VARCHAR(50),
HH_COMP_DESC VARCHAR(50),
HOUSEHOLD_SIZE_DESC VARCHAR(50),
KID_CATEGORY_DESC VARCHAR(50),
household_key INT PRIMARY KEY 
);

SHOW TABLES;
CREATE OR REPLACE TABLE CAMPAIGN_DESC_RAW (
DESCRIPTION  VARCHAR(50),
CAMPAIGN INT ,
START_DAY INT ,
END_DAY INT ,
PRIMARY KEY (DESCRIPTION),
UNIQUE (CAMPAIGN)
);


CREATE OR REPLACE TABLE CAMPAIGN_RAW (
DESCRIPTION  VARCHAR(50),
household_key INT ,
CAMPAIGN INT ,
FOREIGN KEY (DESCRIPTION) REFERENCES CAMPAIGN_DESC_RAW (DESCRIPTION),
FOREIGN KEY (household_key) REFERENCES DEMOGRAPHIC (household_key),
FOREIGN KEY (CAMPAIGN) REFERENCES  CAMPAIGN_DESC_RAW(CAMPAIGN)
);

CREATE OR REPLACE TABLE COUPON_RAW (
COUPON_UPC INT ,
PRODUCT_ID INT , 
CAMPAIGN INT ,
FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCT_RAW (PRODUCT_ID),
FOREIGN KEY (CAMPAIGN) references CAMPAIGN_DESC_RAW(CAMPAIGN)
); 

CREATE OR REPLACE TABLE COUPON_REDEMPT_RAW(
household_key INT,
DAY INT,
COUPON_UPC INT,
CAMPAIGN INT,
FOREIGN KEY (CAMPAIGN) references CAMPAIGN_DESC_RAW(CAMPAIGN),
FOREIGN KEY (household_key) REFERENCES DEMOGRAPHIC (household_key)
);

CREATE OR REPLACE TABLE PRODUCT_RAW (
PRODUCT_ID INT PRIMARY KEY ,
MANUFACTURER INT , 
DEPARTMENT VARCHAR(100),
BRAND VARCHAR(100),
COMMODITY_DESC VARCHAR(100),
SUB_COMMODITY_DESC VARCHAR(100),
CURR_SIZE_OF_PRODUCT VARCHAR(100)
);

CREATE OR REPLACE TABLE TRANSACTION_RAW ( 
HOUSEHOLD_KEY INT , 
BASKET_ID INT ,
DAY INT , 
PRODUCT_ID INT , 
QUANTITY INT ,
SALES_VALUE FLOAT , 
STORE_ID INT ,
RETAIL_DISC FLOAT , 
TRANS_TIME INT ,
WEEK_NO INT ,
COUPON_DISC INT ,
COUPON_MATCH_DISC INT ,
FOREIGN KEY (household_key) REFERENCES DEMOGRAPHIC (household_key),
FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCT_RAW (PRODUCT_ID)
);

SHOW TABLES;

